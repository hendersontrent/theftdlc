<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to theftdlc • theftdlc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to theftdlc">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">theftdlc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/theftdlc.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/hendersontrent/theftdlc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to theftdlc</h1>
                        <h4 data-toc-skip class="author">Trent
Henderson</h4>
            
            <h4 data-toc-skip class="date">2025-07-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hendersontrent/theftdlc/blob/HEAD/vignettes/theftdlc.Rmd" class="external-link"><code>vignettes/theftdlc.Rmd</code></a></small>
      <div class="d-none name"><code>theftdlc.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hendersontrent.github.io/theft/" class="external-link">theft</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hendersontrent.github.io/theftdlc/">theftdlc</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>The <a href="https://hendersontrent.github.io/theft/" class="external-link"><code>theft</code></a>
package for R facilitates user-friendly access to a structured
analytical workflow for the extraction of time-series features from six
different feature sets (and any number of individual user-supplied
features): <code>"catch22"</code>, <code>"feasts"</code>,
<code>"kats"</code>, <code>"tsfeatures"</code>, <code>"tsfresh"</code>,
and <code>"tsfel"</code>. <code>theftdlc</code> extends this
feature-based ecosystem by providing a suite of functions for analysing,
interpreting, and visualising time-series features calculated using
<code>theft</code>.</p>
</div>
<div class="section level2">
<h2 id="core-calculation-functions">Core calculation functions<a class="anchor" aria-label="anchor" href="#core-calculation-functions"></a>
</h2>
<p>To explore package functionality, we are going to use a dataset that
comes standard with <code>theft</code> called <code>simData</code>. This
dataset is a <code>tsibble</code> which contains a collection of
randomly generated time series for six different types of processes. The
dataset can be accessed via:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">theft</span><span class="fu">::</span><span class="va"><a href="https://hendersontrent.github.io/theft/reference/simData.html" class="external-link">simData</a></span></span></code></pre></div>
<p>The data follows the following structure:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simData</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tsibble: 6 x 4 [1]</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Key:       id, process [1]</span></span></span>
<span><span class="co">#&gt;     values timepoint id      process</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  0.091<span style="text-decoration: underline;">8</span>          1 AR(1)_1 AR(1)  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  0.006<span style="text-decoration: underline;">17</span>         2 AR(1)_1 AR(1)  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  0.154           3 AR(1)_1 AR(1)  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  0.100           4 AR(1)_1 AR(1)  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">9</span>          5 AR(1)_1 AR(1)  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> -<span style="color: #BB0000;">0.230</span>           6 AR(1)_1 AR(1)</span></span></code></pre></div>
<p>We will use <code>theft</code> to quickly calculate features using
the <code>catch22</code> set:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://hendersontrent.github.io/theft/reference/calculate_features.html" class="external-link">calculate_features</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simData</span>, </span>
<span>                                     feature_set <span class="op">=</span> <span class="st">"catch22"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-quality-checks">Data quality checks<a class="anchor" aria-label="anchor" href="#data-quality-checks"></a>
</h2>
<p>The core <code>calculate_features</code> function in
<code>theft</code> returns an object of class
<code>feature_calculations</code>. Objects of this type are purposefully
looked-for by other functions in <code>theftdlc</code>. Because it is a
class, simple methods such as <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> can be called on the
object to produce a range of statistical graphics. The first is a
visualisation of the data types of the calculated feature vectors. This
is useful for inspecting which features might need to be dropped due to
large proportions of undesirable (e.g., <code>NA</code>,
<code>NaN</code> etc.) values. We can specify the plot
<code>type = "quality</code> to make this graphic:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"quality"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="data-visualisation-and-low-dimensional-projections">Data visualisation and low-dimensional projections<a class="anchor" aria-label="anchor" href="#data-visualisation-and-low-dimensional-projections"></a>
</h2>
<p>The package also comes with additional statistical and graphical
functionality:</p>
<ul>
<li>Feature by time-series matrix as a heatmap</li>
<li>Low dimensional projections of the feature space and plotting as a
scatterplot</li>
<li>Pairwise feature correlation matrix as a heatmap</li>
</ul>
<div class="section level3">
<h3 id="feature-matrices">Feature matrices<a class="anchor" aria-label="anchor" href="#feature-matrices"></a>
</h3>
<p>The function calling <code>type = "matrix"</code> in
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on a <code>feature_calculations</code> object takes
it and produces a <code>ggplot</code> object heatmap showing the feature
vectors across the <code>x</code> axis and each time series down the
<code>y</code> axis. Prior to plotting, the function hierarchically
clusters the data across both rows and columns to visually highlight the
empirical structure. Note that you have several options for the
hierarchical clustering linkage algorithm to use:</p>
<ul>
<li>
<code>"average"</code> (default)</li>
<li><code>"ward.D"</code></li>
<li><code>"ward.D2"</code></li>
<li><code>"single"</code></li>
<li><code>"complete"</code></li>
<li><code>"mcquitty"</code></li>
<li><code>"median"</code></li>
<li><code>"centroid"</code></li>
</ul>
<p>See the <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/hclust" class="external-link"><code>hclust</code>
documentation</a> for more information.</p>
<p>Note that the legend for this plot (and other matrix visualisations
in <code>theftdlc</code>) have been discretised for visual clarity as
continuous legends can be difficult to interpret meaningful value
differences easily.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"matrix"</span>, norm_method <span class="op">=</span> <span class="st">"RobustSigmoid"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>You can control the normalisation type with the
<code>norm_method</code> argument, whether to rescale to the unit
interval after normalisation with the <code>unit_int</code> argument.
<code>norm_method</code> and all normalisation of feature vectors in
<code>theftdlc</code> is handled by the <a href="https://hendersontrent.github.io/normaliseR/" class="external-link"><code>normaliseR</code></a>
package. You can also control the hierarchical clustering method with
the <code>clust_method</code> argument (the example above used defaults
so manual specification was not needed).</p>
</div>
<div class="section level3">
<h3 id="individual-feature-distributions">Individual feature distributions<a class="anchor" aria-label="anchor" href="#individual-feature-distributions"></a>
</h3>
<p>Plotting the entire feature matrix is useful, but sometimes we wish
to understand the distributions of individual features. This is
particularly useful if there are different groups in your data (such as
in a time-series classification context). We can again use the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> generic here to draw violin plots through setting
<code>type = "violin"</code>. Note that for violin plots, we also need
to tell the function which features we wish to plot (i.e., a vector of
characters specifying feature names from the <code>names</code> column
in your <code>feature_calculations</code> object). For simplicity, we
will just plot two random features from <code>catch22</code> here:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"violin"</span>,</span>
<span>     feature_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO_f1ecac"</span>, <span class="st">"PD_PeriodicityWang_th0_01"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Note that when using these defined <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> generics, you
can pass any additional arguments to certain geoms to control the plot
look through the <code>...</code> argument in the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
function. Below is a guide to where these arguments go depending on the
plot type:</p>
<ul>
<li>
<code>type = "quality"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar</a></code>
</li>
<li>
<code>type = "matrix"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_raster</a></code>
</li>
<li>
<code>type = "cor"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_raster</a></code>
</li>
<li>
<code>type = "violin"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">ggplot2::geom_point</a></code>
</li>
<li>
<code>type = "box"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">ggplot2::geom_boxplot</a></code>
</li>
</ul>
<p>For example, we may wish to control the point size and transparency
in the above plot (not rendered here for space):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"violin"</span>,</span>
<span>     feature_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO_f1ecac"</span>, <span class="st">"PD_PeriodicityWang_th0_01"</span><span class="op">)</span>,</span>
<span>     size <span class="op">=</span> <span class="fl">0.7</span>, alpha <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, we may wish to identify if any univariate outliers
exist by drawing a boxplot instead, which depicts outliers as
points:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"box"</span>,</span>
<span>     feature_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO_f1ecac"</span>, <span class="st">"PD_PeriodicityWang_th0_01"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="low-dimensional-projections">Low dimensional projections<a class="anchor" aria-label="anchor" href="#low-dimensional-projections"></a>
</h3>
<p>Low-dimensional projections are a useful tool for visualising the
structure of high-dimensional datasets in low-dimensional spaces. In
machine learning for time-series data, we are often interested in
representing a time-series dataset in a two-dimensional projection of
the high-dimensional feature space. This projection which can reveal
structure in the dataset, including how different labeled classes are
organized.</p>
<p>The <code>theftdlc</code> function <code>project</code> takes the
<code>feature_calculations</code> object and performs one of the
following dimension reduction techniques on it to reduce its
dimensionality to a bivariate state which can then be easily
plotted:</p>
<ul>
<li>Principal components analysis (PCA)—<code>"PCA"</code>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-Stochastic
Neighbor Embedding
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-SNE)—<code>"tSNE"</code>
</li>
<li>Classical multidimensional scaling
(MDS)—<code>"ClassicalMDS"</code>
</li>
<li>Kruskal’s non-metric multidimensional
scaling—<code>"KruskalMDS"</code>
</li>
<li>Sammon’s non-linear mapping non-metric multidimensional
scaling—<code>"SammonMDS"</code>
</li>
<li>Uniform Manifold Approximation and Projection for Dimension
Reduction (UMAP)—<code>"UMAP"</code>
</li>
</ul>
<p>The result is stored in a custom object class called
<code>feature_projection</code>. <code>project</code> takes the
following arguments:</p>
<ul>
<li>
<code>data</code>—<code>feature_calculations</code> object
containing the raw feature matrix produced by
<code><a href="https://hendersontrent.github.io/theft/reference/calculate_features.html" class="external-link">theft::calculate_features</a></code>
</li>
<li>
<code>norm_method</code>—character denoting the
rescaling/normalising method to apply. Can be one of
<code>"zScore"</code>, <code>"Sigmoid"</code>,
<code>"RobustSigmoid"</code>, <code>"MinMax"</code>, or
<code>"MaxAbs"</code>. Defaults to <code>"zScore"</code>
</li>
<li>
<code>unit_int</code>—Boolean whether to rescale into unit interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math>
after applying normalisation method. Defaults to <code>FALSE</code>
</li>
<li>
<code>low_dim_method</code>—character specifying the low dimensional
embedding method to use. Can be one of <code>"PCA"</code> or
<code>"tSNE"</code>, <code>"ClassicalMDS"</code>,
<code>"KruskalMDS"</code>, <code>"SammonMDS"</code>, or
<code>"UMAP"</code>. Defaults to <code>"PCA"</code>
</li>
<li>
<code>na_removal</code>—character defining the way to deal with
<code>NAs</code> produced during feature calculation. Can be one of
<code>"feature"</code> or <code>"sample"</code>. <code>"feature"</code>
removes all features that produced any <code>NAs</code> in any sample,
keeping the number of samples the same. <code>"sample"</code> omits all
samples that produced at least one <code>NA</code>. Defaults to
<code>"feature"</code>
</li>
<li>
<code>seed</code>—integer to fix R’s random number generator to
ensure reproducibility. Defaults to <code>123</code>
</li>
<li>
<code>...</code> arguments to be passed to the respective function
specified by <code>low_dim_method</code>
</li>
</ul>
<p><code>project</code> returns an object of class
<code>feature_projection</code> which is essentially a named list
comprised of four elements:</p>
<ol style="list-style-type: decimal">
<li>
<code>"Data"</code>—the <code>feature_calculations</code> object
supplied to <code>project</code>
</li>
<li>
<code>"ModelData"</code>—the wide matrix of filtered data supplied
to the model fit</li>
<li>
<code>"ProjectedData"</code>—a tidy <code>data.frame</code> of the
two-dimensional embedding</li>
<li>
<code>"ModelFit"</code>—the raw model object from the dimensionality
reduction algorithm</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low_dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">feature_matrix</span>,</span>
<span>                   norm_method <span class="op">=</span> <span class="st">"RobustSigmoid"</span>,</span>
<span>                   unit_int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   low_dim_method <span class="op">=</span> <span class="st">"PCA"</span>,</span>
<span>                   seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></code></pre></div>
<p>We can similarly call <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on this object to produce a
two-dimensional scatterplot of the results:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">low_dim</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
<p>As another example, a <em>t</em>-SNE version can be specified in a
similar fashion, with any function parameters for the method supplied to
the <code>...</code> argument to <code>project</code>. Shaded covariance
ellipses can also be disabled when plotting
<code>feature_projection</code> objects by setting
<code>show_covariance = FALSE</code>. Here is an example where we modify
the perplexity of the <em>t</em>-SNE algorithm:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low_dim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">feature_matrix</span>,</span>
<span>                    norm_method <span class="op">=</span> <span class="st">"RobustSigmoid"</span>,</span>
<span>                    unit_int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    low_dim_method <span class="op">=</span> <span class="st">"tSNE"</span>,</span>
<span>                    perplexity <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                    seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">low_dim2</span>, show_covariance <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="pairwise-correlations">Pairwise correlations<a class="anchor" aria-label="anchor" href="#pairwise-correlations"></a>
</h3>
<p>You can plot correlations between feature vectors using
<code>plot(type = "cor")</code> on a <code>feature_calculations</code>
object:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"cor"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Similarly, you can control the normalisation type with the
<code>norm_method</code> argument and the hierarchical clustering method
with the <code>clust_method</code> argument (the example above used
defaults so manual specification was not needed).</p>
</div>
</div>
<div class="section level2">
<h2 id="time-series-classification">Time-series classification<a class="anchor" aria-label="anchor" href="#time-series-classification"></a>
</h2>
<div class="section level3">
<h3 id="feature-by-feature">Feature-by-feature<a class="anchor" aria-label="anchor" href="#feature-by-feature"></a>
</h3>
<p>Since feature-based time-series analysis has shown particular promise
for classification problems, <code>theftdlc</code> includes
functionality for exploring group separation. The function
<code>classify</code> enables you to fit a range of classification
models to enable statistical comparisons using the resampling
methodology presented in <a href="https://pakdd2023.org/wp-content/uploads/2023/05/pakdd23_w1_p3.pdf" class="external-link">this
paper</a> for a detailed review<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;T. Henderson, A. G., Bryant, and B. D. Fulcher, “Never a
Dull Moment: Distributional Properties as a Baseline for Time-Series
Classification”, 27th Pacific-Asia Conference on Knowledge Discovery and
Data Mining, 2023.&lt;/p&gt;"><sup>1</sup></a>. This function is meant to serve as a fast
answer that can be used to guide analysis and not a replacement for the
development of a careful statistical pipeline. <code>classify</code> has
the following arguments:</p>
<ul>
<li>
<code>data</code>—<code>feature_calculations</code> object
containing the raw feature matrix produced by
<code><a href="https://hendersontrent.github.io/theft/reference/calculate_features.html" class="external-link">theft::calculate_features</a></code> with an included
<code>group</code> column as per
<code><a href="https://hendersontrent.github.io/theft/reference/calculate_features.html" class="external-link">theft::calculate_features</a></code>
</li>
<li>
<code>classifier</code>—<code>function</code> specifying the
classifier to fit. Should be a function with 2 arguments:
<code>formula</code> and <code>data</code>. Please note that
<code>classify</code> z-scores data prior to modelling using the train
set’s information so disabling default scaling if your function uses it
is recommended. Defaults to <code>NULL</code> which means the following
linear SVM is fit:
<code>classifier = function(formula, data){mod &lt;- e1071::svm(formula, data = data, kernel = "linear", scale = FALSE, probability = TRUE)}</code>
</li>
<li>
<code>train_size</code>—Numeric value denoting the proportion of
samples to use in the training set. Defaults to <code>0.75</code>
</li>
<li>
<code>n_resamples</code>—Integer denoting the number of resamples to
calculate. Defaults to <code>30</code>
</li>
<li>
<code>by_set</code>—Boolean specifying whether to compute
classifiers for each feature set. Defaults to <code>TRUE</code> (see
below section “Multi-feature” for more on this). If <code>FALSE</code>,
the function will instead find the best individually-performing
features</li>
<li>
<code>use_null</code>—Boolean whether to fit null models where class
labels are shuffled in order to generate a null distribution that can be
compared to performance on correct class labels. Defaults to
<code>FALSE</code>. This is known as permutation testing</li>
<li>
<code>seed</code>—Integer to fix R’s random number generator to
ensure reproducibility. Defaults to <code>123</code>
</li>
</ul>
<p>Since we are interested in individual features in this section, we
will calculate both main and null results for each feature using just
<code>5</code> resamples for efficiency (in practice, we would use
more!) with the default linear SVM:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_classifiers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify.html">classify</a></span><span class="op">(</span><span class="va">feature_matrix</span>,</span>
<span>                                by_set <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                n_resamples <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                                use_null <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>To show you how simple it is to specify a different classifier, we
can instead maybe use a radial basis function SVM (though you are
absolutely not limited to just <code>e1071</code> models! You can use
anything that can be used with R’s <code>predict</code> generic as
<code>classify</code> internally constructs confusion matrices from
model predictions):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myclassifier</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html" class="external-link">svm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span>, kernel <span class="op">=</span> <span class="st">"radial"</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">feature_classifiers_radial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify.html">classify</a></span><span class="op">(</span><span class="va">feature_matrix</span>,</span>
<span>                                       classifier <span class="op">=</span> <span class="va">myclassifier</span>,</span>
<span>                                       by_set <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                       n_resamples <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                                       use_null <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>While have raw classification results is useful, we often also would
like to statistical evaluate some facet of it. <code>theftdlc</code>
includes the function <code>compare_features</code> for doing this.
<code>compare_features</code> contains the following arguments:</p>
<ul>
<li>
<code>data</code>—List object containing the classification outputs
produce by <code>classify</code>
</li>
<li>
<code>metric</code>—Character denoting the classification
performance metric to use in statistical testing. Can be one of
<code>"accuracy"</code>, <code>"precision"</code>,
<code>"recall"</code>, <code>"f1"</code>. Defaults to
<code>"accuracy"</code>
</li>
<li>
<code>by_set</code>—Boolean specifying whether you want to compare
feature sets (if <code>TRUE</code>) or individual features (if
<code>FALSE</code>). Defaults to <code>TRUE</code> but this is
contingent on whether you computed by set or not in
<code>classify</code>
</li>
<li>
<code>hypothesis</code>—Character denoting whether p-values should
be calculated for each feature set or feature (depending on
<code>by_set</code> argument) individually relative to the null if
<code>use_null = TRUE</code> in <code>classify</code> through
<code>"null"</code>, or whether pairwise comparisons between each set or
feature should be conducted on main model fits only through
<code>"pairwise"</code>. Defaults to <code>"null"</code>
</li>
<li>
<code>p_adj</code>—Character denoting the adjustment made to
p-values for multiple comparisons. Should be a valid argument to <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/p.adjust" class="external-link"><code>stats::p.adjust</code></a>.
Defaults to <code>"none"</code> for no adjustment. <code>"holm"</code>
is recommended as a starting point if adjustments are sought</li>
<li>
<code>n_workers</code>—Integer denoting the number of parallel
processes to use. Defaults to <code>1</code> for serial processing</li>
</ul>
<p>We can use <code>compare_features</code> to evaluate how well each
individual feature performs relative to its empirical null distribution
(noting that we are using the defaults for the other arguments for code
cleanliness):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_vs_null</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_features.html">compare_features</a></span><span class="op">(</span><span class="va">feature_classifiers</span>,</span>
<span>                                    by_set <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                    hypothesis <span class="op">=</span> <span class="st">"null"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">feature_vs_null</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                 hypothesis</span></span>
<span><span class="co">#&gt; 1 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != own null</span></span>
<span><span class="co">#&gt; 2                            catch22_CO_f1ecac != own null</span></span>
<span><span class="co">#&gt; 3                       catch22_CO_FirstMin_ac != own null</span></span>
<span><span class="co">#&gt; 4             catch22_CO_HistogramAMI_even_2_5 != own null</span></span>
<span><span class="co">#&gt; 5                        catch22_CO_trev_1_num != own null</span></span>
<span><span class="co">#&gt; 6                  catch22_DN_HistogramMode_10 != own null</span></span>
<span><span class="co">#&gt;                                          names</span></span>
<span><span class="co">#&gt; 1 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff</span></span>
<span><span class="co">#&gt; 2                            catch22_CO_f1ecac</span></span>
<span><span class="co">#&gt; 3                       catch22_CO_FirstMin_ac</span></span>
<span><span class="co">#&gt; 4             catch22_CO_HistogramAMI_even_2_5</span></span>
<span><span class="co">#&gt; 5                        catch22_CO_trev_1_num</span></span>
<span><span class="co">#&gt; 6                  catch22_DN_HistogramMode_10</span></span>
<span><span class="co">#&gt;                         original_names feature_set   metric feature_mean</span></span>
<span><span class="co">#&gt; 1 CO_Embed2_Dist_tau_d_expfit_meandiff     catch22 accuracy    0.3333333</span></span>
<span><span class="co">#&gt; 2                            CO_f1ecac     catch22 accuracy    0.3555556</span></span>
<span><span class="co">#&gt; 3                       CO_FirstMin_ac     catch22 accuracy    0.3022222</span></span>
<span><span class="co">#&gt; 4             CO_HistogramAMI_even_2_5     catch22 accuracy    0.3688889</span></span>
<span><span class="co">#&gt; 5                        CO_trev_1_num     catch22 accuracy    0.1377778</span></span>
<span><span class="co">#&gt; 6                  DN_HistogramMode_10     catch22 accuracy    0.0800000</span></span>
<span><span class="co">#&gt;    null_mean t_statistic     p.value</span></span>
<span><span class="co">#&gt; 1 0.05777778   4.7002079 0.004653485</span></span>
<span><span class="co">#&gt; 2 0.06222222          NA          NA</span></span>
<span><span class="co">#&gt; 3 0.11111111   1.8874905 0.066066436</span></span>
<span><span class="co">#&gt; 4 0.07111111   2.4319459 0.035914947</span></span>
<span><span class="co">#&gt; 5 0.07555556   1.7232809 0.079967399</span></span>
<span><span class="co">#&gt; 6 0.10222222  -0.3892495 0.641537068</span></span></code></pre></div>
<p>Or to conduct pairwise comparisons between individual features:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pairwise_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_features.html">compare_features</a></span><span class="op">(</span><span class="va">feature_classifiers</span>,</span>
<span>                                      by_set <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                      hypothesis <span class="op">=</span> <span class="st">"pairwise"</span>,</span>
<span>                                      p_adj <span class="op">=</span> <span class="st">"holm"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pairwise_features</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                         hypothesis</span></span>
<span><span class="co">#&gt; 1                catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_f1ecac</span></span>
<span><span class="co">#&gt; 2           catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_FirstMin_ac</span></span>
<span><span class="co">#&gt; 3 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_HistogramAMI_even_2_5</span></span>
<span><span class="co">#&gt; 4            catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_trev_1_num</span></span>
<span><span class="co">#&gt; 5      catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_DN_HistogramMode_10</span></span>
<span><span class="co">#&gt; 6       catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_DN_HistogramMode_5</span></span>
<span><span class="co">#&gt;                                        names_a                          names_b</span></span>
<span><span class="co">#&gt; 1 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff                catch22_CO_f1ecac</span></span>
<span><span class="co">#&gt; 2 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff           catch22_CO_FirstMin_ac</span></span>
<span><span class="co">#&gt; 3 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff catch22_CO_HistogramAMI_even_2_5</span></span>
<span><span class="co">#&gt; 4 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff            catch22_CO_trev_1_num</span></span>
<span><span class="co">#&gt; 5 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff      catch22_DN_HistogramMode_10</span></span>
<span><span class="co">#&gt; 6 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff       catch22_DN_HistogramMode_5</span></span>
<span><span class="co">#&gt;     metric names_a_mean names_b_mean t_statistic    p.value p_value_adj</span></span>
<span><span class="co">#&gt; 1 accuracy    0.3333333    0.3555556          NA         NA          NA</span></span>
<span><span class="co">#&gt; 2 accuracy    0.3333333    0.3022222   0.9525793 0.39474545   1.0000000</span></span>
<span><span class="co">#&gt; 3 accuracy    0.3333333    0.3688889  -0.5819144 0.59184415   1.0000000</span></span>
<span><span class="co">#&gt; 4 accuracy    0.3333333    0.1377778   4.4907312 0.01089970   1.0000000</span></span>
<span><span class="co">#&gt; 5 accuracy    0.3333333    0.0800000   5.7287155 0.00459701   0.7768946</span></span>
<span><span class="co">#&gt; 6 accuracy    0.3333333    0.1022222   4.8702462 0.00821823   1.0000000</span></span></code></pre></div>
<p><em>NOTE: Although it was not used in this vignette for simplicity,
it is strongly recommended to use parallel processing in</em>
<code>compare_features</code> <em>by setting</em> <code>n_workers</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">&gt;1</annotation></semantics></math>.
<em>Performance benefits will be especially pronounced for pairwise
comparisons.</em></p>
<p>We can then use <code>ggplot2</code> to summarise and visualise our
results. Here is a pairwise correlation plot between the top 10 features
in <code>catch22</code> for this toy problem. We are just simply
filtering the original full feature data and making use of the
<code>plot</code> generic defined for objects of class
<code>feature_calculations</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_10</span> <span class="op">&lt;-</span> <span class="va">feature_vs_null</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span><span class="va">p.value</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">feature_set</span>, <span class="va">original_names</span>, <span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">feature_matrix_filt</span> <span class="op">&lt;-</span> <span class="va">feature_matrix</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">feature_set</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_10</span><span class="op">$</span><span class="va">feature_set</span> <span class="op">&amp;</span> <span class="va">names</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_10</span><span class="op">$</span><span class="va">original_names</span><span class="op">)</span></span>
<span></span>
<span><span class="va">feature_matrix_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="va">feature_matrix_filt</span>, class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"feature_calculations"</span>, <span class="st">"data.frame"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix_filt</span>, type <span class="op">=</span> <span class="st">"cor"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can also easily draw a violin plot of the top 10 features to
visualise the distributions by group:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix_filt</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"violin"</span>,</span>
<span>     feature_names <span class="op">=</span> <span class="va">top_10</span><span class="op">$</span><span class="va">original_names</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;"></p>
<p><code>theftdlc</code> also contains a function <code>interval</code>
for summarising the results of <code>classify</code>.
<code>interval</code> returns an object of class
<code>interval_calculations</code> which is a data frame containing the
summary information. <code>interval</code> takes the following
arguments:</p>
<ul>
<li>
<code>data</code>—list object containing the classification outputs
produce by <code>classify</code>
</li>
<li>
<code>metric</code>—character denoting the classification
performance metric to calculate intervals for. Can be one of
<code>"accuracy"</code>, <code>"precision"</code>,
<code>"recall"</code>, <code>"f1"</code>. Defaults to
<code>"accuracy"</code>
</li>
<li>
<code>by_set</code>—Boolean specifying whether to compute intervals
for each feature set. Defaults to <code>TRUE</code>. If
<code>FALSE</code>, the function will instead calculate intervals for
each feature</li>
<li>
<code>type</code>—character denoting whether to calculate a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>±</mi><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
SD interval with <code>"sd"</code>, confidence interval based off the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-distribution
with <code>"qt"</code>, or based on a quantile with
<code>"quantile"</code>. Defaults to <code>"sd"</code>
</li>
<li>
<code>interval</code>—numeric scalar denoting the width of the
interval to calculate. Defaults to <code>1</code> if
<code>type = "sd"</code> to produce a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>±</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">\pm 1</annotation></semantics></math>
SD interval. Defaults to <code>0.95</code> if <code>type = "qt"</code>
or <code>type = "quantile"</code> for a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math>
interval</li>
<li>
<code>model_type</code>—character denoting whether to calculate
intervals for main models with <code>"main"</code> or null models with
<code>"null"</code> if the <code>use_null</code> argument when using
<code>classify</code> was <code>use_null = TRUE</code>. Defaults to
<code>"main"</code>
</li>
</ul>
<p>We can evidently use <code>interval</code> to produce a variety of
different summaries for us. For example, we might wish to compute the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>±</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">\pm1</annotation></semantics></math>
SD interval for each feature’s main model classification accuracy values
(note that the defaults for the function do this for us, so we only need
to set <code>by_set = FALSE</code> manually):</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/interval.html">interval</a></span><span class="op">(</span><span class="va">feature_classifiers</span>, by_set <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                  names      .mean     .lower</span></span>
<span><span class="co">#&gt; 1         catch22_CO_Embed2_Dist_tau_d_expfit_meandiff 0.33333333 0.31111111</span></span>
<span><span class="co">#&gt; 2                                    catch22_CO_f1ecac 0.35555556 0.35555556</span></span>
<span><span class="co">#&gt; 3                               catch22_CO_FirstMin_ac 0.30222222 0.26185355</span></span>
<span><span class="co">#&gt; 4                     catch22_CO_HistogramAMI_even_2_5 0.36888889 0.32852022</span></span>
<span><span class="co">#&gt; 5                                catch22_CO_trev_1_num 0.13777778 0.11343455</span></span>
<span><span class="co">#&gt; 6                          catch22_DN_HistogramMode_10 0.08000000 0.05018576</span></span>
<span><span class="co">#&gt; 7                           catch22_DN_HistogramMode_5 0.10222222 0.04427376</span></span>
<span><span class="co">#&gt; 8                catch22_DN_OutlierInclude_n_001_mdrmd 0.08888889 0.07317540</span></span>
<span><span class="co">#&gt; 9                catch22_DN_OutlierInclude_p_001_mdrmd 0.09777778 0.07244055</span></span>
<span><span class="co">#&gt; 10              catch22_FC_LocalSimple_mean1_tauresrat 0.46222222 0.39858746</span></span>
<span><span class="co">#&gt; 11                 catch22_FC_LocalSimple_mean3_stderr 0.56444444 0.53910721</span></span>
<span><span class="co">#&gt; 12     catch22_IN_AutoMutualInfoStats_40_gaussian_fmmi 0.19111111 0.15740944</span></span>
<span><span class="co">#&gt; 13                        catch22_MD_hrv_classic_pnn40 0.21777778 0.17503248</span></span>
<span><span class="co">#&gt; 14                   catch22_PD_PeriodicityWang_th0_01 0.25777778 0.22059289</span></span>
<span><span class="co">#&gt; 15            catch22_SB_BinaryStats_diff_longstretch0 0.21777778 0.15814930</span></span>
<span><span class="co">#&gt; 16            catch22_SB_BinaryStats_mean_longstretch1 0.29333333 0.27474089</span></span>
<span><span class="co">#&gt; 17                   catch22_SB_MotifThree_quantile_hh 0.40000000 0.35030960</span></span>
<span><span class="co">#&gt; 18          catch22_SB_TransitionMatrix_3ac_sumdiagcov 0.24444444 0.22873096</span></span>
<span><span class="co">#&gt; 19      catch22_SC_FluctAnal_2_dfa_50_1_2_logi_prop_r1 0.11111111 0.06397066</span></span>
<span><span class="co">#&gt; 20 catch22_SC_FluctAnal_2_rsrangefit_50_1_logi_prop_r1 0.13777778 0.10126294</span></span>
<span><span class="co">#&gt; 21            catch22_SP_Summaries_welch_rect_area_5_1 0.68888889 0.65039887</span></span>
<span><span class="co">#&gt; 22            catch22_SP_Summaries_welch_rect_centroid 0.45777778 0.39185601</span></span>
<span><span class="co">#&gt;       .upper</span></span>
<span><span class="co">#&gt; 1  0.3555556</span></span>
<span><span class="co">#&gt; 2  0.3555556</span></span>
<span><span class="co">#&gt; 3  0.3425909</span></span>
<span><span class="co">#&gt; 4  0.4092576</span></span>
<span><span class="co">#&gt; 5  0.1621210</span></span>
<span><span class="co">#&gt; 6  0.1098142</span></span>
<span><span class="co">#&gt; 7  0.1601707</span></span>
<span><span class="co">#&gt; 8  0.1046024</span></span>
<span><span class="co">#&gt; 9  0.1231150</span></span>
<span><span class="co">#&gt; 10 0.5258570</span></span>
<span><span class="co">#&gt; 11 0.5897817</span></span>
<span><span class="co">#&gt; 12 0.2248128</span></span>
<span><span class="co">#&gt; 13 0.2605231</span></span>
<span><span class="co">#&gt; 14 0.2949627</span></span>
<span><span class="co">#&gt; 15 0.2774063</span></span>
<span><span class="co">#&gt; 16 0.3119258</span></span>
<span><span class="co">#&gt; 17 0.4496904</span></span>
<span><span class="co">#&gt; 18 0.2601579</span></span>
<span><span class="co">#&gt; 19 0.1582516</span></span>
<span><span class="co">#&gt; 20 0.1742926</span></span>
<span><span class="co">#&gt; 21 0.7273789</span></span>
<span><span class="co">#&gt; 22 0.5236995</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multi-feature">Multi-feature<a class="anchor" aria-label="anchor" href="#multi-feature"></a>
</h3>
<p>Since <code>theft</code> contains entire sets of features, we can
also use <code>classify</code> to compare them at the set level through
the <code>by_set</code> argument. Let’s try both <code>catch22</code>
and a custom set of just mean and standard deviation:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_matrix2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://hendersontrent.github.io/theft/reference/calculate_features.html" class="external-link">calculate_features</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simData</span>, </span>
<span>                                      feature_set <span class="op">=</span> <span class="st">"catch22"</span>,</span>
<span>                                      features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mean"</span> <span class="op">=</span> <span class="va">mean</span>, <span class="st">"sd"</span> <span class="op">=</span> <span class="va">sd</span><span class="op">)</span>,</span>
<span>                                      seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">set_classifiers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify.html">classify</a></span><span class="op">(</span><span class="va">feature_matrix2</span>,</span>
<span>                            by_set <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            n_resamples <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                            use_null <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">set_classifiers</span><span class="op">)</span></span>
<span><span class="co">#&gt; $TrainTestSizes</span></span>
<span><span class="co">#&gt; train_size  test_size </span></span>
<span><span class="co">#&gt;        135         45 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ClassificationResults</span></span>
<span><span class="co">#&gt;    model_type resample   accuracy mean_precision mean_recall mean_f1_score</span></span>
<span><span class="co">#&gt; 1        Main        1 0.84444444     0.86574074  0.88827839     0.8682359</span></span>
<span><span class="co">#&gt; 2        Main        2 0.91111111     0.92592593  0.92592593     0.9259259</span></span>
<span><span class="co">#&gt; 3        Main        3 0.75555556     0.79166667  0.81649832     0.8002646</span></span>
<span><span class="co">#&gt; 4        Main        4 0.77777778     0.81018519  0.81693122     0.8126706</span></span>
<span><span class="co">#&gt; 5        Main        5 0.80000000     0.83333333  0.83333333     0.8328173</span></span>
<span><span class="co">#&gt; 6        Null        1 0.13333333     0.19490741  0.11458333     0.1980420</span></span>
<span><span class="co">#&gt; 7        Null        2 0.13333333     0.14709596  0.17216811     0.1527193</span></span>
<span><span class="co">#&gt; 8        Null        3 0.08888889     0.08888889  0.11309524     0.2986111</span></span>
<span><span class="co">#&gt; 9        Null        4 0.33333333     0.36582492  0.36984127     0.3244168</span></span>
<span><span class="co">#&gt; 10       Null        5 0.13333333     0.10332492  0.16730769     0.2411616</span></span>
<span><span class="co">#&gt; 11       Main        1 0.82222222     0.85185185  0.85281385     0.8500000</span></span>
<span><span class="co">#&gt; 12       Main        2 0.77777778     0.81481481  0.81481481     0.8148148</span></span>
<span><span class="co">#&gt; 13       Main        3 0.75555556     0.79629630  0.79583333     0.7956656</span></span>
<span><span class="co">#&gt; 14       Main        4 0.82222222     0.85185185  0.85281385     0.8500000</span></span>
<span><span class="co">#&gt; 15       Main        5 0.80000000     0.83333333  0.83333333     0.8285714</span></span>
<span><span class="co">#&gt; 16       Null        1 0.11111111     0.16666667  0.23809524     0.8333333</span></span>
<span><span class="co">#&gt; 17       Null        2 0.26666667     0.33333333  0.30912162     0.4683794</span></span>
<span><span class="co">#&gt; 18       Null        3 0.08888889     0.13333333  0.20000000     0.8000000</span></span>
<span><span class="co">#&gt; 19       Null        4 0.11111111     0.16666667  0.31250000     0.7692308</span></span>
<span><span class="co">#&gt; 20       Null        5 0.02222222     0.05555556  0.05555556     0.2222222</span></span>
<span><span class="co">#&gt; 21       Main        1 0.77777778     0.79537037  0.78860029     0.7878788</span></span>
<span><span class="co">#&gt; 22       Main        2 0.82222222     0.84953704  0.83201058     0.8373812</span></span>
<span><span class="co">#&gt; 23       Main        3 0.66666667     0.68564815  0.71801347     0.6931883</span></span>
<span><span class="co">#&gt; 24       Main        4 0.71111111     0.75462963  0.73547980     0.7180744</span></span>
<span><span class="co">#&gt; 25       Main        5 0.77777778     0.80000000  0.79814815     0.7901961</span></span>
<span><span class="co">#&gt; 26       Null        1 0.13333333     0.15787037  0.11428571     0.2346154</span></span>
<span><span class="co">#&gt; 27       Null        2 0.08888889     0.07302189  0.11666667     0.1300595</span></span>
<span><span class="co">#&gt; 28       Null        3 0.11111111     0.10740741  0.15714286     0.2511905</span></span>
<span><span class="co">#&gt; 29       Null        4 0.26666667     0.24936869  0.27910053     0.2931502</span></span>
<span><span class="co">#&gt; 30       Null        5 0.08888889     0.06965488  0.12777778     0.1790598</span></span>
<span><span class="co">#&gt;     feature_set</span></span>
<span><span class="co">#&gt; 1  All features</span></span>
<span><span class="co">#&gt; 2  All features</span></span>
<span><span class="co">#&gt; 3  All features</span></span>
<span><span class="co">#&gt; 4  All features</span></span>
<span><span class="co">#&gt; 5  All features</span></span>
<span><span class="co">#&gt; 6  All features</span></span>
<span><span class="co">#&gt; 7  All features</span></span>
<span><span class="co">#&gt; 8  All features</span></span>
<span><span class="co">#&gt; 9  All features</span></span>
<span><span class="co">#&gt; 10 All features</span></span>
<span><span class="co">#&gt; 11         User</span></span>
<span><span class="co">#&gt; 12         User</span></span>
<span><span class="co">#&gt; 13         User</span></span>
<span><span class="co">#&gt; 14         User</span></span>
<span><span class="co">#&gt; 15         User</span></span>
<span><span class="co">#&gt; 16         User</span></span>
<span><span class="co">#&gt; 17         User</span></span>
<span><span class="co">#&gt; 18         User</span></span>
<span><span class="co">#&gt; 19         User</span></span>
<span><span class="co">#&gt; 20         User</span></span>
<span><span class="co">#&gt; 21      catch22</span></span>
<span><span class="co">#&gt; 22      catch22</span></span>
<span><span class="co">#&gt; 23      catch22</span></span>
<span><span class="co">#&gt; 24      catch22</span></span>
<span><span class="co">#&gt; 25      catch22</span></span>
<span><span class="co">#&gt; 26      catch22</span></span>
<span><span class="co">#&gt; 27      catch22</span></span>
<span><span class="co">#&gt; 28      catch22</span></span>
<span><span class="co">#&gt; 29      catch22</span></span>
<span><span class="co">#&gt; 30      catch22</span></span></code></pre></div>
<p>Note that <code>classify</code> constructs a set of
<code>"All features"</code> (i.e., all features across all computed
sets) automatically when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">&gt;2</annotation></semantics></math>
unique feature sets are detected in the feature data. Since
<code>interval</code> returns an S3 object, we can use the
<code>plot</code> generic to automatically draw a useful visual
summary:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interval_calcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interval.html">interval</a></span><span class="op">(</span><span class="va">set_classifiers</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">interval_calcs</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="cluster-analysis">Cluster analysis<a class="anchor" aria-label="anchor" href="#cluster-analysis"></a>
</h2>
<p><code>theftdlc</code> also supports quick and simple cluster analysis
using either <a href="https://en.wikipedia.org/wiki/K-means_clustering" class="external-link"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-means</a>,
hierarchical clustering, or <a href="https://en.wikipedia.org/wiki/Mixture_model" class="external-link">Gaussian mixture
models</a> through the <code>cluster</code> function.
<code>cluster</code> takes a few similar key arguments to other
<code>theftdlc</code> functions (though defaults are set for all, and so
only <code>data</code> is required for <code>cluster</code> to
work):</p>
<ul>
<li>
<code>data</code>—<code>feature_calculations</code> object
containing the raw feature matrix produced by
<code><a href="https://hendersontrent.github.io/theft/reference/calculate_features.html" class="external-link">theft::calculate_features</a></code>
</li>
<li>
<code>norm_method</code>—character denoting the
rescaling/normalising method to apply. Can be one of
<code>"zScore"</code>, <code>"Sigmoid"</code>,
<code>"RobustSigmoid"</code>, <code>"MinMax"</code>, or
<code>"MaxAbs"</code>. Defaults to <code>"zScore"</code>
</li>
<li>
<code>unit_int</code>—Boolean whether to rescale into unit interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0,1]</annotation></semantics></math>
after applying normalisation method. Defaults to <code>FALSE</code>
</li>
<li>
<code>clust_method</code>—character specifying the clustering
algorithm to use. Can be one of <code>"kmeans"</code>,
<code>"hclust"</code>, or <code>"mclust"</code>. Defaults to
<code>"kmeans"</code>
</li>
<li>
<code>k</code>—integer denoting the number of clusters to extract.
Defaults to <code>2</code>
</li>
<li>
<code>features</code>—character vector denoting the names of
time-series features to use in the clustering algorithm. Defaults to
<code>NULL</code> for no feature filtering and usage of the entire
feature matrix</li>
<li>
<code>na_removal</code>—character defining the way to deal with
<code>NAs</code> produced during feature calculation. Can be one of
<code>"feature"</code> or <code>"sample"</code>. <code>"feature"</code>
removes all features that produced any <code>NAs</code> in any sample,
keeping the number of samples the same. <code>"sample"</code> omits all
samples that produced at least one <code>NA</code>. Defaults to
<code>"feature"</code>
</li>
<li>
<code>seed</code>—integer to fix R’s random number generator to
ensure reproducibility. Defaults to <code>123</code>
</li>
<li>
<code>...</code>—additional arguments to be passed to
<code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">stats::kmeans</a></code>, <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">stats::hclust</a></code>, or
<code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">mclust::Mclust</a></code> depending on <code>clust_method</code>
</li>
</ul>
<p><code>cluster</code> returns an object of class
<code>feature_clusters</code> which is essentially a named list
comprised of two elements:</p>
<ol style="list-style-type: decimal">
<li>
<code>"Data"</code>—the <code>feature_calculations</code> object
supplied to <code>cluster</code> with the cluster label appended</li>
<li>
<code>"ModelFit"</code>—the raw model object from the clustering
algorithm</li>
</ol>
<p>We can easily fit a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-means
model with <code>k = 6</code> (since <code><a href="https://hendersontrent.github.io/theft/reference/simData.html" class="external-link">theft::simData</a></code>
contains data for six different temporal processes):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster.html">cluster</a></span><span class="op">(</span><span class="va">feature_matrix</span>, k <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p>From here, it’s easy to do any further analysis or data
visualisation:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_clusters</span><span class="op">$</span><span class="va">Data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">names</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO_HistogramAMI_even_2_5"</span>, </span>
<span>                               <span class="st">"DN_OutlierInclude_p_001_mdrmd"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"group"</span>, <span class="st">"cluster"</span><span class="op">)</span>, </span>
<span>                       names_from <span class="op">=</span> <span class="st">"names"</span>, values_from <span class="op">=</span> <span class="st">"values"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CO_HistogramAMI_even_2_5</span>, </span>
<span>                                 <span class="va">DN_OutlierInclude_p_001_mdrmd</span>, </span>
<span>                                 colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html" class="external-link">stat_ellipse</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>, geom <span class="op">=</span> <span class="st">"polygon"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                   panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="feature-selection">Feature selection<a class="anchor" aria-label="anchor" href="#feature-selection"></a>
</h2>
<p>Feature selection is a well-studied field, and the selection approach
for a given problem should be carefully considered.
<code>theftdlc</code> offers a simple option for users seeking fast
answers through the <code>shrink</code> function, which implements a
cross-validated penalised maximum likelihood generalized linear model
through the <code>glmnet</code> package. Since <code>theftdlc</code> is
largely concerned with time-series classification, this is currently
only possible if <code>calculate_features</code> has a
<code>group</code> column. Specifically, for the binomial case,
<code>shrink</code> finds the time-series features whose coefficients
are non-zero, and for the multinomial case (i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">&gt;2</annotation></semantics></math>
groups) <code>shrink</code> finds the time-series features who are
non-zero across all group distinctions. <code>shrink</code> only takes
four arguments and returns a <code>feature_calculations</code> object
that can be used with all of <code>theftdlc</code>, just like
<code>calculate_features</code>:</p>
<ol style="list-style-type: decimal">
<li>
<code>data</code> — the <code>feature_calculations</code>
object</li>
<li>
<code>threshold</code> — applies to multinomial (i.e., multiclass)
classification problems only. Determines whether to retain features that
have at least one non-zero coefficient across all the different classes
(<code>threshold = "one"</code>) or features that have non-zero
coefficients across all the classes (<code>threshold = "all"</code>).
Defaults to <code>"one"</code> for less aggressive filtering</li>
<li>
<code>plot</code> — whether to plot the misclassification error
lambda plot for the CV model. Defaults to <code>FALSE</code>
</li>
<li>
<code>...</code> — additional arguments that are passed to
<code><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">glmnet::cv.glmnet</a></code> to control the model fitting process</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_matrix_red</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/shrink.html">shrink</a></span><span class="op">(</span><span class="va">feature_matrix</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-25-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can then compare the number of features between our original set
and the reduced feature set:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">feature_matrix</span><span class="op">$</span><span class="va">names</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 22</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">feature_matrix_red</span><span class="op">$</span><span class="va">names</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4</span></span></code></pre></div>
<p>We see that the selection process retained only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>4</mn><annotation encoding="application/x-tex">4</annotation></semantics></math>
features. Note that this process is far more useful in higher
dimensional cases, such as when features from all six sets in
<code>theft</code> are calculated.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Trent Henderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
