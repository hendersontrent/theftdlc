<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="theftdlc">
<title>Introduction to theftdlc • theftdlc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to theftdlc">
<meta property="og:description" content="theftdlc">
<meta property="og:image" content="https://hendersontrent.github.io/theftdlc/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">theftdlc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/theftdlc.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/hendersontrent/theftdlc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to theftdlc</h1>
                        <h4 data-toc-skip class="author">Trent
Henderson</h4>
            
            <h4 data-toc-skip class="date">2024-03-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/hendersontrent/theftdlc/blob/HEAD/vignettes/theftdlc.Rmd" class="external-link"><code>vignettes/theftdlc.Rmd</code></a></small>
      <div class="d-none name"><code>theftdlc.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hendersontrent.github.io/theft/" class="external-link">theft</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hendersontrent.github.io/theftdlc/">theftdlc</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>The <a href="https://hendersontrent.github.io/theft/" class="external-link"><code>theft</code></a>
package for R facilitates user-friendly access to a structured
analytical workflow for the extraction of time-series features from six
different feature sets (or a set of user-supplied features):
<code>"catch22"</code>, <code>"feasts"</code>, <code>"Kats"</code>,
<code>"tsfeatures"</code>, <code>"tsfresh"</code>, and
<code>"TSFEL"</code> <code>theftdlc</code> extends this feature-based
ecosystem by providing a suite of functions for analysing, interpreting,
and visualising time-series features calculated using
<code>theft</code>.</p>
</div>
<div class="section level2">
<h2 id="core-calculation-functions">Core calculation functions<a class="anchor" aria-label="anchor" href="#core-calculation-functions"></a>
</h2>
<p>To explore package functionality, we are going to use a dataset that
comes standard with <code>theft</code> called <code>simData</code>. This
dataset contains a collection of randomly generated time series for six
different types of processes. The dataset can be accessed via:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">theft</span><span class="fu">::</span><span class="va"><a href="https://hendersontrent.github.io/theft/reference/simData.html" class="external-link">simData</a></span></span></code></pre></div>
<p>The data follows the following structure:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simData</span><span class="op">)</span></span>
<span><span class="co">#&gt;                      values timepoint               id        process</span></span>
<span><span class="co">#&gt; Gaussian Noise.1 -0.6264538         1 Gaussian Noise_1 Gaussian Noise</span></span>
<span><span class="co">#&gt; Gaussian Noise.2  0.1836433         2 Gaussian Noise_1 Gaussian Noise</span></span>
<span><span class="co">#&gt; Gaussian Noise.3 -0.8356286         3 Gaussian Noise_1 Gaussian Noise</span></span>
<span><span class="co">#&gt; Gaussian Noise.4  1.5952808         4 Gaussian Noise_1 Gaussian Noise</span></span>
<span><span class="co">#&gt; Gaussian Noise.5  0.3295078         5 Gaussian Noise_1 Gaussian Noise</span></span>
<span><span class="co">#&gt; Gaussian Noise.6 -0.8204684         6 Gaussian Noise_1 Gaussian Noise</span></span></code></pre></div>
<p>We will use <code>theft</code> to quickly calculate features using
the <code>catch22</code> set:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://hendersontrent.github.io/theft/reference/calculate_features.html" class="external-link">calculate_features</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simData</span>, </span>
<span>                                     id_var <span class="op">=</span> <span class="st">"id"</span>, </span>
<span>                                     time_var <span class="op">=</span> <span class="st">"timepoint"</span>, </span>
<span>                                     values_var <span class="op">=</span> <span class="st">"values"</span>, </span>
<span>                                     group_var <span class="op">=</span> <span class="st">"process"</span>, </span>
<span>                                     feature_set <span class="op">=</span> <span class="st">"catch22"</span>,</span>
<span>                                     seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-quality-checks">Data quality checks<a class="anchor" aria-label="anchor" href="#data-quality-checks"></a>
</h2>
<p>The core <code>calculate_features</code> function in
<code>theft</code> returns an object of class
<code>feature_calculations</code>. Objects of this type are purposefully
looked-for by other functions in <code>theftdlc</code>. Because it is a
class, simple methods such as <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> can be called on the
object to produce a range of statistical graphics. The first is a
visualisation of the data types of the calculated feature vectors. This
is useful for inspecting which features might need to be dropped due to
large proportions of undesirable (e.g., <code>NA</code>,
<code>NaN</code> etc.) values. We can specify the plot
<code>type = "quality</code> to make this graphic:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"quality"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="data-visualisation-and-low-dimensional-projections">Data visualisation and low-dimensional projections<a class="anchor" aria-label="anchor" href="#data-visualisation-and-low-dimensional-projections"></a>
</h2>
<p>The package also comes with additional statistical and graphical
functionality:</p>
<ul>
<li>Feature by time-series matrix as a heatmap</li>
<li>Low dimensional projections of the feature space and plotting as a
scatterplot</li>
<li>Pairwise feature correlation matrix as a heatmap</li>
</ul>
<div class="section level3">
<h3 id="feature-matrices">Feature matrices<a class="anchor" aria-label="anchor" href="#feature-matrices"></a>
</h3>
<p>The function calling <code>type = "matrix"</code> in
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on a <code>feature_calculations</code> object takes
it and produces a <code>ggplot</code> object heatmap showing the feature
vectors across the <code>x</code> axis and each time series down the
<code>y</code> axis. Prior to plotting, the function hierarchically
clusters the data across both rows and columns to visually highlight the
empirical structure. Note that you have several options for the
hierarchical clustering linkage algorithm to use:</p>
<ul>
<li>
<code>"average"</code> (default)</li>
<li><code>"ward.D"</code></li>
<li><code>"ward.D2"</code></li>
<li><code>"single"</code></li>
<li><code>"complete"</code></li>
<li><code>"mcquitty"</code></li>
<li><code>"median"</code></li>
<li><code>"centroid"</code></li>
</ul>
<p>See the <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/hclust" class="external-link"><code>hclust</code>
documentation</a> for more information.</p>
<p>Note that the legend for this plot (and other matrix visualisations
in <code>theftdlc</code>) have been discretised for visual clarity as
continuous legends can be difficult to interpret meaningful value
differences easily.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"matrix"</span>, norm_method <span class="op">=</span> <span class="st">"RobustSigmoid"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>You can control the normalisation type with the
<code>norm_method</code> argument, whether to rescale to the unit
interval after normalisation with the <code>unit_int</code> argument.
<code>norm_method</code> and all normalisation of feature vectors in
<code>theftdlc</code> is handled by the <a href="https://hendersontrent.github.io/normaliseR/" class="external-link"><code>normaliseR</code></a>
package. You can also control the hierarchical clustering method with
the <code>clust_method</code> argument (the example above used defaults
so manual specification was not needed).</p>
</div>
<div class="section level3">
<h3 id="individual-feature-distributions">Individual feature distributions<a class="anchor" aria-label="anchor" href="#individual-feature-distributions"></a>
</h3>
<p>Plotting the entire feature matrix is useful, but sometimes we wish
to understand the distributions of individual features. This is
particularly useful if there are different groups in your data (such as
in a time-series classification context). We can again use the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> generic here to draw violin plots through setting
<code>type = "violin"</code>. Note that for violin plots, we also need
to tell the function which features we wish to plot (i.e., a vector of
characters specifying feature names from the <code>names</code> column
in your <code>feature_calculations</code> object). For simplicity, we
will just plot two random features from <code>catch22</code> here:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"violin"</span>,</span>
<span>     feature_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO_f1ecac"</span>, <span class="st">"PD_PeriodicityWang_th0_01"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Note that when using these defined <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> generics, you
can pass any additional arguments to certain geoms to control the plot
look through the <code>...</code> argument in the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
function. Below is a guide to where these arguments go depending on the
plot type:</p>
<ul>
<li>
<code>type = "quality"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar</a></code>
</li>
<li>
<code>type = "matrix"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_raster</a></code>
</li>
<li>
<code>type = "cor"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_raster</a></code>
</li>
<li>
<code>type = "violin"</code>—<code>...</code> goes to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">ggplot2::geom_point</a></code>
</li>
</ul>
<p>For example, we may wish to control the point size and transparency
in the above plot (not rendered here for space):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"violin"</span>,</span>
<span>     feature_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO_f1ecac"</span>, <span class="st">"PD_PeriodicityWang_th0_01"</span><span class="op">)</span>,</span>
<span>     size <span class="op">=</span> <span class="fl">0.7</span>, alpha <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="low-dimensional-projections">Low dimensional projections<a class="anchor" aria-label="anchor" href="#low-dimensional-projections"></a>
</h3>
<p>Low-dimensional projections are a useful tool for visualising the
structure of high-dimensional datasets in low-dimensional spaces. In
machine learning for time-series data, we are often interested in
representing a time-series dataset in a two-dimensional projection of
the high-dimensional feature space. This projection which can reveal
structure in the dataset, including how different labeled classes are
organized.</p>
<p>The <code>theftdlc</code> function <code>project</code> takes the
<code>feature_calculations</code> object and performs one of the
following dimension reduction techniques on it to reduce its
dimensionality to a bivariate state which can then be easily
plotted:</p>
<ul>
<li>Principal components analysis (PCA)—<code>"PCA"</code>
</li>
<li>
<span class="math inline">\(t\)</span>-Stochastic Neighbor Embedding
(<span class="math inline">\(t\)</span>-SNE)—<code>"tSNE"</code>
</li>
<li>Classical multidimensional scaling
(MDS)—<code>"ClassicalMDS"</code>
</li>
<li>Kruskal’s non-metric multidimensional
scaling—<code>"KruskalMDS"</code>
</li>
<li>Sammon’s non-linear mapping non-metric multidimensional
scaling—<code>"SammonMDS"</code>
</li>
<li>Uniform Manifold Approximation and Projection for Dimension
Reduction (UMAP)—<code>"UMAP"</code>
</li>
</ul>
<p>The result is stored in a custom object class called
<code>feature_projection</code>. <code>project</code> takes the
following arguments:</p>
<ul>
<li>
<code>data</code>—<code>feature_calculations</code> object
containing the raw feature matrix produced by
<code><a href="https://hendersontrent.github.io/theft/reference/calculate_features.html" class="external-link">theft::calculate_features</a></code>
</li>
<li>
<code>norm_method</code>—character denoting the
rescaling/normalising method to apply. Can be one of
<code>"zScore"</code>, <code>"Sigmoid"</code>,
<code>"RobustSigmoid"</code>, <code>"MinMax"</code>, or
<code>"MaxAbs"</code>. Defaults to <code>"zScore"</code>
</li>
<li>
<code>unit_int</code>—Boolean whether to rescale into unit interval
<span class="math inline">\([0,1]\)</span> after applying normalisation
method. Defaults to <code>FALSE</code>
</li>
<li>
<code>low_dim_method</code>—character specifying the low dimensional
embedding method to use. Can be one of <code>"PCA"</code> or
<code>"tSNE"</code>, <code>"ClassicalMDS"</code>,
<code>"KruskalMDS"</code>, <code>"SammonMDS"</code>, or
<code>"UMAP"</code>. Defaults to <code>"PCA"</code>
</li>
<li>
<code>na_removal</code>—character defining the way to deal with
<code>NAs</code> produced during feature calculation. Can be one of
<code>"feature"</code> or <code>"sample"</code>. <code>"feature"</code>
removes all features that produced any <code>NAs</code> in any sample,
keeping the number of samples the same. <code>"sample"</code> omits all
samples that produced at least one <code>NA</code>. Defaults to
<code>"feature"</code>
</li>
<li>
<code>seed</code>—integer to fix R’s random number generator to
ensure reproducibility. Defaults to <code>123</code>
</li>
<li>
<code>...</code> arguments to be passed to the respective function
specified by <code>low_dim_method</code>
</li>
</ul>
<p><code>project</code> returns an object of class
<code>feature_projection</code> which is essentially a named list
comprised of four elements:</p>
<ol style="list-style-type: decimal">
<li>
<code>"Data"</code>—the <code>feature_calculations</code> object
supplied to <code>project</code>
</li>
<li>
<code>"ModelData"</code>—the wide matrix of filtered data supplied
to the model fit</li>
<li>
<code>"ProjectedData"</code>—a tidy <code>data.frame</code> of the
two-dimensional embedding</li>
<li>
<code>"ModelFit"</code>—the raw model object from the dimensionality
reduction algorithm</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low_dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">feature_matrix</span>,</span>
<span>                   norm_method <span class="op">=</span> <span class="st">"RobustSigmoid"</span>,</span>
<span>                   unit_int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   low_dim_method <span class="op">=</span> <span class="st">"PCA"</span>,</span>
<span>                   seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></code></pre></div>
<p>We can similarly call <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on this object to produce a
two-dimensional scatterplot of the results:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">low_dim</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>As another example, a <em>t</em>-SNE version can be specified in a
similar fashion, with any function parameters for the method supplied to
the <code>...</code> argument to <code>project</code>. Shaded covariance
ellipses can also be disabled when plotting
<code>feature_projection</code> objects by setting
<code>show_covariance = FALSE</code>. Here is an example where we modify
the perplexity of the <em>t</em>-SNE algorithm:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low_dim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">feature_matrix</span>,</span>
<span>                    norm_method <span class="op">=</span> <span class="st">"RobustSigmoid"</span>,</span>
<span>                    unit_int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    low_dim_method <span class="op">=</span> <span class="st">"tSNE"</span>,</span>
<span>                    perplexity <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                    seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">low_dim2</span>, show_covariance <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="pairwise-correlations">Pairwise correlations<a class="anchor" aria-label="anchor" href="#pairwise-correlations"></a>
</h3>
<p>You can plot correlations between feature vectors using
<code>plot(type = "cor")</code> on a <code>feature_calculations</code>
object:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix</span>, type <span class="op">=</span> <span class="st">"cor"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Similarly, you can control the normalisation type with the
<code>norm_method</code> argument and the hierarchical clustering method
with the <code>clust_method</code> argument (the example above used
defaults so manual specification was not needed).</p>
</div>
</div>
<div class="section level2">
<h2 id="time-series-classification">Time-series classification<a class="anchor" aria-label="anchor" href="#time-series-classification"></a>
</h2>
<div class="section level3">
<h3 id="feature-by-feature">Feature-by-feature<a class="anchor" aria-label="anchor" href="#feature-by-feature"></a>
</h3>
<p>Since feature-based time-series analysis has shown particular promise
for classification problems, <code>theftdlc</code> includes
functionality for exploring group separation. The function
<code>classify</code> enables you to fit a range of classification
models to enable statistical comparisons using the resampling
methodology presented in <a href="https://pakdd2023.org/wp-content/uploads/2023/05/pakdd23_w1_p3.pdf" class="external-link">this
paper</a> for a detailed review<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. This function is meant to serve as a fast
answer that can be used to guide analysis and not a replacement for the
development of a careful statistical pipeline. <code>classify</code> has
the following arguments:</p>
<ul>
<li>
<code>data</code>—<code>feature_calculations</code> object
containing the raw feature matrix produced by
<code><a href="https://hendersontrent.github.io/theft/reference/calculate_features.html" class="external-link">theft::calculate_features</a></code> with an included
<code>group</code> column as per
<code><a href="https://hendersontrent.github.io/theft/reference/calculate_features.html" class="external-link">theft::calculate_features</a></code>
</li>
<li>
<code>classifier</code>—<code>function</code> specifying the
classifier to fit. Should be a function with 2 arguments:
<code>formula</code> and <code>data</code>. Please note that
<code>classify</code> z-scores data prior to modelling using the train
set’s information so disabling default scaling if your function uses it
is recommended. Defaults to <code>NULL</code> which means the following
linear SVM is fit:
<code>classifier = function(formula, data){mod &lt;- e1071::svm(formula, data = data, kernel = "linear", scale = FALSE, probability = TRUE)}</code>
</li>
<li>
<code>train_size</code>—Numeric value denoting the proportion of
samples to use in the training set. Defaults to <code>0.75</code>
</li>
<li>
<code>n_resamples</code>—Integer denoting the number of resamples to
calculate. Defaults to <code>30</code>
</li>
<li>
<code>by_set</code>—Boolean specifying whether to compute
classifiers for each feature set. Defaults to <code>TRUE</code> (see
below section “Multi-feature” for more on this). If <code>FALSE</code>,
the function will instead find the best individually-performing
features</li>
<li>
<code>use_null</code>—Boolean whether to fit null models where class
labels are shuffled in order to generate a null distribution that can be
compared to performance on correct class labels. Defaults to
<code>FALSE</code>. This is known as permutation testing</li>
<li>
<code>seed</code>—Integer to fix R’s random number generator to
ensure reproducibility. Defaults to <code>123</code>
</li>
</ul>
<p>Since we are interested in individual features in this section, we
will calculate both main and null results for each feature using just
<code>5</code> resamples for efficiency (in practice, we would use
more!) with the default linear SVM:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_classifiers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify.html">classify</a></span><span class="op">(</span><span class="va">feature_matrix</span>,</span>
<span>                                by_set <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                n_resamples <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                                use_null <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>To show you how simple it is to specify a different classifier, we
can instead maybe use a radial basis function SVM (though you are
absolutely not limited to just <code>e1071</code> models! You can use
anything that can be used with R’s <code>predict</code> generic as
<code>classify</code> internally constructs confusion matrices from
model predictions):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myclassifier</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html" class="external-link">svm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span>, kernel <span class="op">=</span> <span class="st">"radial"</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                    probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">feature_classifiers_radial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify.html">classify</a></span><span class="op">(</span><span class="va">feature_matrix</span>,</span>
<span>                                       classifier <span class="op">=</span> <span class="va">myclassifier</span>,</span>
<span>                                       by_set <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                       n_resamples <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                                       use_null <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>While have raw classification results is useful, we often also would
like to statistical evaluate some facet of it. <code>theftdlc</code>
includes the function <code>compare_features</code> for doing this.
<code>compare_features</code> contains the following arguments:</p>
<ul>
<li>
<code>data</code>—List object containing the classification outputs
produce by <code>classify</code>
</li>
<li>
<code>metric</code>—Character denoting the classification
performance metric to use in statistical testing. Can be one of
<code>"accuracy"</code>, <code>"precision"</code>,
<code>"recall"</code>, <code>"f1"</code>. Defaults to
<code>"accuracy"</code>
</li>
<li>
<code>by_set</code>—Boolean specifying whether you want to compare
feature sets (if <code>TRUE</code>) or individual features (if
<code>FALSE</code>). Defaults to <code>TRUE</code> but this is
contingent on whether you computed by set or not in
<code>classify</code>
</li>
<li>
<code>hypothesis</code>—Character denoting whether p-values should
be calculated for each feature set or feature (depending on
<code>by_set</code> argument) individually relative to the null if
<code>use_null = TRUE</code> in <code>classify</code> through
<code>"null"</code>, or whether pairwise comparisons between each set or
feature should be conducted on main model fits only through
<code>"pairwise"</code>. Defaults to <code>"null"</code>
</li>
<li>
<code>p_adj</code>—Character denoting the adjustment made to
p-values for multiple comparisons. Should be a valid argument to <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/p.adjust" class="external-link"><code>stats::p.adjust</code></a>.
Defaults to <code>"none"</code> for no adjustment. <code>"holm"</code>
is recommended as a starting point if adjustments are sought</li>
</ul>
<p>We can use <code>compare_features</code> to evaluate how well each
individual feature performs relative to its empirical null distribution
(noting that we are using the defaults for the other arguments for code
cleanliness):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_vs_null</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_features.html">compare_features</a></span><span class="op">(</span><span class="va">feature_classifiers</span>,</span>
<span>                                    by_set <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                    hypothesis <span class="op">=</span> <span class="st">"null"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">feature_vs_null</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                 hypothesis</span></span>
<span><span class="co">#&gt; 1 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != own null</span></span>
<span><span class="co">#&gt; 2                            catch22_CO_f1ecac != own null</span></span>
<span><span class="co">#&gt; 3                       catch22_CO_FirstMin_ac != own null</span></span>
<span><span class="co">#&gt; 4             catch22_CO_HistogramAMI_even_2_5 != own null</span></span>
<span><span class="co">#&gt; 5                        catch22_CO_trev_1_num != own null</span></span>
<span><span class="co">#&gt; 6                  catch22_DN_HistogramMode_10 != own null</span></span>
<span><span class="co">#&gt;                                          names</span></span>
<span><span class="co">#&gt; 1 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff</span></span>
<span><span class="co">#&gt; 2                            catch22_CO_f1ecac</span></span>
<span><span class="co">#&gt; 3                       catch22_CO_FirstMin_ac</span></span>
<span><span class="co">#&gt; 4             catch22_CO_HistogramAMI_even_2_5</span></span>
<span><span class="co">#&gt; 5                        catch22_CO_trev_1_num</span></span>
<span><span class="co">#&gt; 6                  catch22_DN_HistogramMode_10</span></span>
<span><span class="co">#&gt;                         original_names feature_set   metric feature_mean</span></span>
<span><span class="co">#&gt; 1 CO_Embed2_Dist_tau_d_expfit_meandiff     catch22 accuracy   0.40444444</span></span>
<span><span class="co">#&gt; 2                            CO_f1ecac     catch22 accuracy   0.29777778</span></span>
<span><span class="co">#&gt; 3                       CO_FirstMin_ac     catch22 accuracy   0.31111111</span></span>
<span><span class="co">#&gt; 4             CO_HistogramAMI_even_2_5     catch22 accuracy   0.29777778</span></span>
<span><span class="co">#&gt; 5                        CO_trev_1_num     catch22 accuracy   0.11111111</span></span>
<span><span class="co">#&gt; 6                  DN_HistogramMode_10     catch22 accuracy   0.08444444</span></span>
<span><span class="co">#&gt;    null_mean t_statistic     p.value</span></span>
<span><span class="co">#&gt; 1 0.12000000    4.894202 0.008077588</span></span>
<span><span class="co">#&gt; 2 0.09777778    2.371708 0.076678140</span></span>
<span><span class="co">#&gt; 3 0.09777778    2.317462 0.081362957</span></span>
<span><span class="co">#&gt; 4 0.10666667    2.007068 0.115183542</span></span>
<span><span class="co">#&gt; 5 0.07111111    3.674235 0.021311641</span></span>
<span><span class="co">#&gt; 6 0.06666667    0.560112 0.605286626</span></span></code></pre></div>
<p>Or to conduct pairwise comparisons between individual features:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pairwise_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_features.html">compare_features</a></span><span class="op">(</span><span class="va">feature_classifiers</span>,</span>
<span>                                      by_set <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                      hypothesis <span class="op">=</span> <span class="st">"pairwise"</span>,</span>
<span>                                      p_adj <span class="op">=</span> <span class="st">"holm"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pairwise_features</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                                         hypothesis</span></span>
<span><span class="co">#&gt; 1                catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_f1ecac</span></span>
<span><span class="co">#&gt; 2           catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_FirstMin_ac</span></span>
<span><span class="co">#&gt; 3 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_HistogramAMI_even_2_5</span></span>
<span><span class="co">#&gt; 4            catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_CO_trev_1_num</span></span>
<span><span class="co">#&gt; 5      catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_DN_HistogramMode_10</span></span>
<span><span class="co">#&gt; 6       catch22_CO_Embed2_Dist_tau_d_expfit_meandiff != catch22_DN_HistogramMode_5</span></span>
<span><span class="co">#&gt;                                        names_a                          names_b</span></span>
<span><span class="co">#&gt; 1 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff                catch22_CO_f1ecac</span></span>
<span><span class="co">#&gt; 2 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff           catch22_CO_FirstMin_ac</span></span>
<span><span class="co">#&gt; 3 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff catch22_CO_HistogramAMI_even_2_5</span></span>
<span><span class="co">#&gt; 4 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff            catch22_CO_trev_1_num</span></span>
<span><span class="co">#&gt; 5 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff      catch22_DN_HistogramMode_10</span></span>
<span><span class="co">#&gt; 6 catch22_CO_Embed2_Dist_tau_d_expfit_meandiff       catch22_DN_HistogramMode_5</span></span>
<span><span class="co">#&gt;     metric names_a_mean names_b_mean t_statistic      p.value p_value_adj</span></span>
<span><span class="co">#&gt; 1 accuracy    0.4044444   0.29777778    5.237229 6.352257e-03   1.0000000</span></span>
<span><span class="co">#&gt; 2 accuracy    0.4044444   0.31111111    3.500000 2.489616e-02   1.0000000</span></span>
<span><span class="co">#&gt; 3 accuracy    0.4044444   0.29777778    2.449490 7.048400e-02   1.0000000</span></span>
<span><span class="co">#&gt; 4 accuracy    0.4044444   0.11111111    9.241849 7.620017e-04   0.1699264</span></span>
<span><span class="co">#&gt; 5 accuracy    0.4044444   0.08444444    6.743418 2.520576e-03   0.5368828</span></span>
<span><span class="co">#&gt; 6 accuracy    0.4044444   0.06222222   15.717559 9.571521e-05   0.0220145</span></span></code></pre></div>
<p>We can then use <code>ggplot2</code> to summarise and visualise our
results. Here is a pairwise correlation plot between the top 10 features
in <code>catch22</code> for this toy problem. We are just simply
filtering the original full feature data and making use of the
<code>plot</code> generic defined for objects of class
<code>feature_calculations</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_10</span> <span class="op">&lt;-</span> <span class="va">feature_vs_null</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min</a></span><span class="op">(</span><span class="va">p.value</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">feature_set</span>, <span class="va">original_names</span>, <span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">feature_matrix_filt</span> <span class="op">&lt;-</span> <span class="va">feature_matrix</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">feature_set</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_10</span><span class="op">$</span><span class="va">feature_set</span> <span class="op">&amp;</span> <span class="va">names</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_10</span><span class="op">$</span><span class="va">original_names</span><span class="op">)</span></span>
<span></span>
<span><span class="va">feature_matrix_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="va">feature_matrix_filt</span>, class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"feature_calculations"</span>, <span class="st">"data.frame"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix_filt</span>, type <span class="op">=</span> <span class="st">"cor"</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can also easily draw a violin plot of the top 10 features to
visualise the distributions by group:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feature_matrix_filt</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"violin"</span>,</span>
<span>     feature_names <span class="op">=</span> <span class="va">top_10</span><span class="op">$</span><span class="va">original_names</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Finally, <code>theftdlc</code> also contains a function
<code>interval</code> for summarising the results of
<code>classify</code>. <code>interval</code> takes the following
arguments:</p>
<ul>
<li>
<code>data</code>—list object containing the classification outputs
produce by <code>classify</code>
</li>
<li>
<code>metric</code>—character denoting the classification
performance metric to calculate intervals for. Can be one of
<code>"accuracy"</code>, <code>"precision"</code>,
<code>"recall"</code>, <code>"f1"</code>. Defaults to
<code>"accuracy"</code>
</li>
<li>
<code>by_set</code>—Boolean specifying whether to compute intervals
for each feature set. Defaults to <code>TRUE</code>. If
<code>FALSE</code>, the function will instead calculate intervals for
each feature</li>
<li>
<code>type</code>—character denoting whether to calculate a <span class="math inline">\(\pm\)</span> SD interval with <code>"sd"</code>,
confidence interval based off the <span class="math inline">\(t\)</span>-distribution with <code>"qt"</code>, or
based on a quantile with <code>"quantile"</code>. Defaults to
<code>"sd"</code>
</li>
<li>
<code>interval</code>—numeric scalar denoting the width of the
interval to calculate. Defaults to <code>1</code> if
<code>type = "sd"</code> to produce a <span class="math inline">\(\pm
1\)</span> SD interval. Defaults to <code>0.95</code> if
<code>type = "qt"</code> or <code>type = "quantile"</code> for a <span class="math inline">\(95\%\)</span> interval</li>
<li>
<code>model_type</code>—character denoting whether to calculate
intervals for main models with <code>"main"</code> or null models with
<code>"null"</code> if the <code>use_null</code> argument when using
<code>classify</code> was <code>use_null = TRUE</code>. Defaults to
<code>"main"</code>
</li>
</ul>
<p>We can evidently use <code>interval</code> to produce a variety of
different summaries for us. For example, we might wish to compute the
<span class="math inline">\(\pm1\)</span> SD interval for each feature’s
main model classification accuracy values (note that the defaults for
the function do this for us, so we only need to set
<code>by_set = FALSE</code> manually):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/interval.html">interval</a></span><span class="op">(</span><span class="va">feature_classifiers</span>, by_set <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                  names      .mean     .lower</span></span>
<span><span class="co">#&gt; 1         catch22_CO_Embed2_Dist_tau_d_expfit_meandiff 0.40444444 0.38585200</span></span>
<span><span class="co">#&gt; 2                                    catch22_CO_f1ecac 0.29777778 0.27790162</span></span>
<span><span class="co">#&gt; 3                               catch22_CO_FirstMin_ac 0.31111111 0.28888889</span></span>
<span><span class="co">#&gt; 4                     catch22_CO_HistogramAMI_even_2_5 0.29777778 0.26407611</span></span>
<span><span class="co">#&gt; 5                                catch22_CO_trev_1_num 0.11111111 0.09539763</span></span>
<span><span class="co">#&gt; 6                          catch22_DN_HistogramMode_10 0.08444444 0.05547021</span></span>
<span><span class="co">#&gt; 7                           catch22_DN_HistogramMode_5 0.06222222 0.05228414</span></span>
<span><span class="co">#&gt; 8                catch22_DN_OutlierInclude_n_001_mdrmd 0.05777778 0.04560617</span></span>
<span><span class="co">#&gt; 9                catch22_DN_OutlierInclude_p_001_mdrmd 0.06222222 0.02246990</span></span>
<span><span class="co">#&gt; 10              catch22_FC_LocalSimple_mean1_tauresrat 0.28888889 0.25746192</span></span>
<span><span class="co">#&gt; 11                 catch22_FC_LocalSimple_mean3_stderr 0.50222222 0.47688499</span></span>
<span><span class="co">#&gt; 12     catch22_IN_AutoMutualInfoStats_40_gaussian_fmmi 0.29333333 0.27474089</span></span>
<span><span class="co">#&gt; 13                        catch22_MD_hrv_classic_pnn40 0.25333333 0.18931173</span></span>
<span><span class="co">#&gt; 14                   catch22_PD_PeriodicityWang_th0_01 0.15111111 0.13251867</span></span>
<span><span class="co">#&gt; 15            catch22_SB_BinaryStats_diff_longstretch0 0.33333333 0.28121760</span></span>
<span><span class="co">#&gt; 16            catch22_SB_BinaryStats_mean_longstretch1 0.35111111 0.30836581</span></span>
<span><span class="co">#&gt; 17                   catch22_SB_MotifThree_quantile_hh 0.46222222 0.43324799</span></span>
<span><span class="co">#&gt; 18          catch22_SB_TransitionMatrix_3ac_sumdiagcov 0.32000000 0.27391902</span></span>
<span><span class="co">#&gt; 19      catch22_SC_FluctAnal_2_dfa_50_1_2_logi_prop_r1 0.08444444 0.06010122</span></span>
<span><span class="co">#&gt; 20 catch22_SC_FluctAnal_2_rsrangefit_50_1_logi_prop_r1 0.25333333 0.22799610</span></span>
<span><span class="co">#&gt; 21            catch22_SP_Summaries_welch_rect_area_5_1 0.60000000 0.56486358</span></span>
<span><span class="co">#&gt; 22            catch22_SP_Summaries_welch_rect_centroid 0.53333333 0.50611678</span></span>
<span><span class="co">#&gt;        .upper</span></span>
<span><span class="co">#&gt; 1  0.42303689</span></span>
<span><span class="co">#&gt; 2  0.31765394</span></span>
<span><span class="co">#&gt; 3  0.33333333</span></span>
<span><span class="co">#&gt; 4  0.33147945</span></span>
<span><span class="co">#&gt; 5  0.12682460</span></span>
<span><span class="co">#&gt; 6  0.11341868</span></span>
<span><span class="co">#&gt; 7  0.07216030</span></span>
<span><span class="co">#&gt; 8  0.06994939</span></span>
<span><span class="co">#&gt; 9  0.10197454</span></span>
<span><span class="co">#&gt; 10 0.32031586</span></span>
<span><span class="co">#&gt; 11 0.52755945</span></span>
<span><span class="co">#&gt; 12 0.31192578</span></span>
<span><span class="co">#&gt; 13 0.31735493</span></span>
<span><span class="co">#&gt; 14 0.16970356</span></span>
<span><span class="co">#&gt; 15 0.38544906</span></span>
<span><span class="co">#&gt; 16 0.39385641</span></span>
<span><span class="co">#&gt; 17 0.49119646</span></span>
<span><span class="co">#&gt; 18 0.36608098</span></span>
<span><span class="co">#&gt; 19 0.10878767</span></span>
<span><span class="co">#&gt; 20 0.27867057</span></span>
<span><span class="co">#&gt; 21 0.63513642</span></span>
<span><span class="co">#&gt; 22 0.56054989</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multi-feature">Multi-feature<a class="anchor" aria-label="anchor" href="#multi-feature"></a>
</h3>
<p>Since <code>theft</code> contains entire sets of features, we can
also use <code>classify</code> to compare them at the set level through
the <code>by_set</code> argument. Let’s try both <code>catch22</code>
and a custom set of just mean and standard deviation:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_matrix2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://hendersontrent.github.io/theft/reference/calculate_features.html" class="external-link">calculate_features</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simData</span>, </span>
<span>                                      group_var <span class="op">=</span> <span class="st">"process"</span>, </span>
<span>                                      feature_set <span class="op">=</span> <span class="st">"catch22"</span>,</span>
<span>                                      features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"mean"</span> <span class="op">=</span> <span class="va">mean</span>, <span class="st">"sd"</span> <span class="op">=</span> <span class="va">sd</span><span class="op">)</span>,</span>
<span>                                      seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">set_classifiers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify.html">classify</a></span><span class="op">(</span><span class="va">feature_matrix2</span>,</span>
<span>                            by_set <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            n_resamples <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                            use_null <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">set_classifiers</span><span class="op">)</span></span>
<span><span class="co">#&gt; $TrainTestSizes</span></span>
<span><span class="co">#&gt; train_size  test_size </span></span>
<span><span class="co">#&gt;        135         45 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ClassificationResults</span></span>
<span><span class="co">#&gt;    model_type resample   accuracy mean_precision mean_recall mean_f1_score</span></span>
<span><span class="co">#&gt; 1        Main        1 0.86666667     0.90235690  0.90235690     0.9000000</span></span>
<span><span class="co">#&gt; 2        Main        2 0.84444444     0.88047138  0.88194444     0.8806479</span></span>
<span><span class="co">#&gt; 3        Main        3 0.80000000     0.84785354  0.82702020     0.8317460</span></span>
<span><span class="co">#&gt; 4        Main        4 0.82222222     0.86195286  0.86446886     0.8611111</span></span>
<span><span class="co">#&gt; 5        Main        5 0.86666667     0.89562290  0.90109890     0.8958333</span></span>
<span><span class="co">#&gt; 6        Null        1 0.15555556     0.16734007  0.15575397     0.2266282</span></span>
<span><span class="co">#&gt; 7        Null        2 0.13333333     0.18518519  0.10370370     0.3771930</span></span>
<span><span class="co">#&gt; 8        Null        3 0.06666667     0.10404040  0.07936508     0.1444444</span></span>
<span><span class="co">#&gt; 9        Null        4 0.24444444     0.26153199  0.27103175     0.2406925</span></span>
<span><span class="co">#&gt; 10       Null        5 0.24444444     0.22853535  0.23164683     0.2714130</span></span>
<span><span class="co">#&gt; 11       Main        1 0.71111111     0.79629630  0.83285714     0.8658046</span></span>
<span><span class="co">#&gt; 12       Main        2 0.73333333     0.81481481  0.85666667     0.8941914</span></span>
<span><span class="co">#&gt; 13       Main        3 0.68888889     0.77546296  0.78285714     0.8238998</span></span>
<span><span class="co">#&gt; 14       Main        4 0.71111111     0.79629630  0.83285714     0.8658046</span></span>
<span><span class="co">#&gt; 15       Main        5 0.68888889     0.77777778  0.81500000     0.8379841</span></span>
<span><span class="co">#&gt; 16       Null        1 0.00000000     0.00000000  0.00000000           NaN</span></span>
<span><span class="co">#&gt; 17       Null        2 0.28888889     0.35416667  0.35294118     0.4358312</span></span>
<span><span class="co">#&gt; 18       Null        3 0.04444444     0.04166667  0.20000000     0.4000000</span></span>
<span><span class="co">#&gt; 19       Null        4 0.11111111     0.20833333  0.26923077     0.2714286</span></span>
<span><span class="co">#&gt; 20       Null        5 0.11111111     0.16666667  0.06410256     0.2272727</span></span>
<span><span class="co">#&gt; 21       Main        1 0.68888889     0.72727273  0.68398268     0.6865741</span></span>
<span><span class="co">#&gt; 22       Main        2 0.62222222     0.59764310  0.60178710     0.7068449</span></span>
<span><span class="co">#&gt; 23       Main        3 0.75555556     0.80744949  0.75476190     0.7578947</span></span>
<span><span class="co">#&gt; 24       Main        4 0.77777778     0.79124579  0.77167508     0.7766106</span></span>
<span><span class="co">#&gt; 25       Main        5 0.68888889     0.76430976  0.70138889     0.7086835</span></span>
<span><span class="co">#&gt; 26       Null        1 0.17777778     0.19730640  0.19444444     0.3869031</span></span>
<span><span class="co">#&gt; 27       Null        2 0.08888889     0.10774411  0.08215488     0.1638889</span></span>
<span><span class="co">#&gt; 28       Null        3 0.08888889     0.08552189  0.12500000     0.1939394</span></span>
<span><span class="co">#&gt; 29       Null        4 0.26666667     0.24532828  0.27420635     0.3099160</span></span>
<span><span class="co">#&gt; 30       Null        5 0.17777778     0.15172559  0.14587496     0.2203209</span></span>
<span><span class="co">#&gt;     feature_set</span></span>
<span><span class="co">#&gt; 1  All features</span></span>
<span><span class="co">#&gt; 2  All features</span></span>
<span><span class="co">#&gt; 3  All features</span></span>
<span><span class="co">#&gt; 4  All features</span></span>
<span><span class="co">#&gt; 5  All features</span></span>
<span><span class="co">#&gt; 6  All features</span></span>
<span><span class="co">#&gt; 7  All features</span></span>
<span><span class="co">#&gt; 8  All features</span></span>
<span><span class="co">#&gt; 9  All features</span></span>
<span><span class="co">#&gt; 10 All features</span></span>
<span><span class="co">#&gt; 11         User</span></span>
<span><span class="co">#&gt; 12         User</span></span>
<span><span class="co">#&gt; 13         User</span></span>
<span><span class="co">#&gt; 14         User</span></span>
<span><span class="co">#&gt; 15         User</span></span>
<span><span class="co">#&gt; 16         User</span></span>
<span><span class="co">#&gt; 17         User</span></span>
<span><span class="co">#&gt; 18         User</span></span>
<span><span class="co">#&gt; 19         User</span></span>
<span><span class="co">#&gt; 20         User</span></span>
<span><span class="co">#&gt; 21      catch22</span></span>
<span><span class="co">#&gt; 22      catch22</span></span>
<span><span class="co">#&gt; 23      catch22</span></span>
<span><span class="co">#&gt; 24      catch22</span></span>
<span><span class="co">#&gt; 25      catch22</span></span>
<span><span class="co">#&gt; 26      catch22</span></span>
<span><span class="co">#&gt; 27      catch22</span></span>
<span><span class="co">#&gt; 28      catch22</span></span>
<span><span class="co">#&gt; 29      catch22</span></span>
<span><span class="co">#&gt; 30      catch22</span></span></code></pre></div>
<p>Note that <code>classify</code> constructs a set of
<code>"All features"</code> (i.e., all features across all computed
sets) automatically when <span class="math inline">\(&gt;2\)</span>
unique feature sets are detected in the feature data. Similar to the
individual feature case, we can also use <code>interval</code> combined
with <code>ggplot2</code> to summarise our findings. Here is a
comparison of mean accuracy <span class="math inline">\(\pm 1SD\)</span>
between feature sets:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interval_calcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/interval.html">interval</a></span><span class="op">(</span><span class="va">set_classifiers</span><span class="op">)</span></span>
<span></span>
<span><span class="va">interval_calcs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">feature_set</span>, <span class="op">-</span><span class="va">.mean</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">.mean</span>,</span>
<span>                               colour <span class="op">=</span> <span class="va">feature_set</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.lower</span>, ymax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Feature set"</span>,</span>
<span>                y <span class="op">=</span> <span class="st">"Classification accuracy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                 panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="cluster-analysis">Cluster analysis<a class="anchor" aria-label="anchor" href="#cluster-analysis"></a>
</h2>
<p><code>theftdlc</code> also supports quick and simple cluster analysis
using either <a href="https://en.wikipedia.org/wiki/K-means_clustering" class="external-link"><span class="math inline">\(k\)</span>-means</a>, hierarchical clustering, or
<a href="https://en.wikipedia.org/wiki/Mixture_model" class="external-link">Gaussian mixture
models</a> through the <code>cluster</code> function.
<code>cluster</code> takes a few similar key arguments to other
<code>theftdlc</code> functions (though defaults are set for all, and so
only <code>data</code> is required for <code>cluster</code> to
work):</p>
<ul>
<li>
<code>data</code>—<code>feature_calculations</code> object
containing the raw feature matrix produced by
<code><a href="https://hendersontrent.github.io/theft/reference/calculate_features.html" class="external-link">theft::calculate_features</a></code>
</li>
<li>
<code>norm_method</code>—character denoting the
rescaling/normalising method to apply. Can be one of
<code>"zScore"</code>, <code>"Sigmoid"</code>,
<code>"RobustSigmoid"</code>, <code>"MinMax"</code>, or
<code>"MaxAbs"</code>. Defaults to <code>"zScore"</code>
</li>
<li>
<code>unit_int</code>—Boolean whether to rescale into unit interval
<span class="math inline">\([0,1]\)</span> after applying normalisation
method. Defaults to <code>FALSE</code>
</li>
<li>
<code>clust_method</code>—character specifying the clustering
algorithm to use. Can be one of <code>"kmeans"</code>,
<code>"hclust"</code>, or <code>"mclust"</code>. Defaults to
<code>"kmeans"</code>
</li>
<li>
<code>k</code>—integer denoting the number of clusters to extract.
Defaults to <code>2</code>
</li>
<li>
<code>features</code>—character vector denoting the names of
time-series features to use in the clustering algorithm. Defaults to
<code>NULL</code> for no feature filtering and usage of the entire
feature matrix</li>
<li>
<code>na_removal</code>—character defining the way to deal with
<code>NAs</code> produced during feature calculation. Can be one of
<code>"feature"</code> or <code>"sample"</code>. <code>"feature"</code>
removes all features that produced any <code>NAs</code> in any sample,
keeping the number of samples the same. <code>"sample"</code> omits all
samples that produced at least one <code>NA</code>. Defaults to
<code>"feature"</code>
</li>
<li>
<code>seed</code>—integer to fix R’s random number generator to
ensure reproducibility. Defaults to <code>123</code>
</li>
<li>
<code>...</code>—additional arguments to be passed to
<code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">stats::kmeans</a></code>, <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">stats::hclust</a></code>, or
<code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">mclust::Mclust</a></code> depending on <code>clust_method</code>
</li>
</ul>
<p><code>cluster</code> returns an object of class
<code>feature_clusters</code> which is essentially a named list
comprised of two elements:</p>
<ol style="list-style-type: decimal">
<li>
<code>"Data"</code>—the <code>feature_calculations</code> object
supplied to <code>cluster</code> with the cluster label appended</li>
<li>
<code>"ModelFit"</code>—the raw model object from the clustering
algorithm</li>
</ol>
<p>We can easily fit a <span class="math inline">\(k\)</span>-means
model with <code>k = 6</code> (since <code><a href="https://hendersontrent.github.io/theft/reference/simData.html" class="external-link">theft::simData</a></code>
contains data for six different temporal processes):</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster.html">cluster</a></span><span class="op">(</span><span class="va">feature_matrix</span>, k <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p>From here, it’s easy to do any further analysis or data
visualisation:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feature_clusters</span><span class="op">$</span><span class="va">Data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">names</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO_HistogramAMI_even_2_5"</span>, </span>
<span>                               <span class="st">"DN_OutlierInclude_p_001_mdrmd"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"group"</span>, <span class="st">"cluster"</span><span class="op">)</span>, </span>
<span>                       names_from <span class="op">=</span> <span class="st">"names"</span>, values_from <span class="op">=</span> <span class="st">"values"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CO_HistogramAMI_even_2_5</span>, </span>
<span>                                 <span class="va">DN_OutlierInclude_p_001_mdrmd</span>, </span>
<span>                                 colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ellipse.html" class="external-link">stat_ellipse</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span>, geom <span class="op">=</span> <span class="st">"polygon"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>                   panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="theftdlc_files/figure-html/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>T. Henderson, A. G., Bryant, and B. D. Fulcher, “Never a
Dull Moment: Distributional Properties as a Baseline for Time-Series
Classification”, 27th Pacific-Asia Conference on Knowledge Discovery and
Data Mining, 2023.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Trent Henderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
